webpackJsonp(["app/js/open-course-manage/lesson/index"],{"007f16bb16735f901b3c":function(e,n,t){"use strict";var s=t("33687ed90ec81811e04e");new(function(e){return e&&e.__esModule?e:{default:e}}(s).default)},"33687ed90ec81811e04e":function(e,n,t){"use strict";function s(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,n){for(var t=0;t<n.length;t++){var s=n[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(n,t,s){return t&&e(n.prototype,t),s&&e(n,s),n}}(),o=function(){function e(){s(this,e),this.$item=$(".js-open-course-lesson-item"),this.init()}return a(e,[{key:"init",value:function(){$(".js-file-delete-lesson").tooltip(),this.asyncLoadFiles(),this.bindEvent()}},{key:"bindEvent",value:function(){var e=this;this.$item.on("click",".js-publish-lesson-btn",function(n){return e.publishLesson(n)}),this.$item.on("click",".js-unpublish-lesson-btn",function(){return e.cancelPublishLesson(event)}),this.$item.on("click",".js-delete-lesson-btn",function(){return e.deleteLesson(event)}),$(".js-lesson-create-btn").on("click",function(){return e.createLesson(event)})}},{key:"publishLesson",value:function(e){var n=$(e.target),t=Translator.trans("open_course.publish_lesson_hint");this.togglePublish(n,t)}},{key:"cancelPublishLesson",value:function(e){var n=$(e.target),t=Translator.trans("open_course.unpublish_success_hint");this.togglePublish(n,t)}},{key:"togglePublish",value:function(e,n){$.post(e.data("url"),function(e){$(".js-publish-lesson-btn, .js-delete-lesson-btn, .js-unpublish-lesson-btn").parent().toggleClass("hidden"),$(".js-unpublish-status").toggleClass("hidden"),cd.message({type:"success",message:n})})}},{key:"deleteLesson",value:function(e){var n=this,t=$(e.target);cd.confirm({title:Translator.trans("site.delete"),content:Translator.trans("open_course.lesson_delete_hint"),okText:Translator.trans("site.confirm"),cancelText:Translator.trans("site.close")}).on("ok",function(){$.post(t.data("url"),function(e){n.$item.remove(),$(".js-lesson-notify").show(),$(".js-lesson-create-btn").attr("disabled",!1),cd.message({type:"success",message:Translator.trans("open_course.lesson_delete_success_hint")})},"json")})}},{key:"createLesson",value:function(e){var n=$(e.target).data("url");$.get(n,function(e){e.result?cd.message({type:"warning",message:Translator.trans("open_course.add_lesson_hint")}):($("#modal").html(e),$("#modal").modal("show"))})}},{key:"asyncLoadFiles",value:function(){var e=this,n=$(".js-lesson-manage-panel").data("file-status-url"),t=this.$item.data("fileId");$.post(n,{ids:t},function(n){if(n&&0!=n.length){var t=n[0];"waiting"==t.convertStatus||"doing"==t.convertStatus?e.$item.find('span[data-role="mediaStatus"]').append("<span class='text-warning'>"+Translator.trans("open_course.file_format_conversion_hint")+"</span>"):"error"==t.convertStatus&&e.$item.find('span[data-role="mediaStatus"]').append("<span class='text-danger'>"+Translator.trans("open_course.file_format_conversion_failed_hint")+"</span>")}})}}]),e}();n.default=o}},["007f16bb16735f901b3c"]);